<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Module ldclient_flagbuilder</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module ldclient_flagbuilder</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#types">Data Types</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>Flagbuilder.


<h2><a name="description">Description</a></h2>Flagbuilder
 
<h2><a name="types">Data Types</a></h2>

<h3 class="typedecl"><a name="type-flag_builder">flag_builder()</a></h3>
<p><b>abstract datatype</b>: <tt>flag_builder()</tt></p>
<p>  A builder for feature flag configurations to be used with <a docgen-rel="seeerl" docgen-href="ldclient_testdata" href="ldclient_testdata.html"><code>ldclient_testdata</code></a>.</p>

<h3 class="typedecl"><a name="type-flag_rule_builder">flag_rule_builder()</a></h3>
<p><b>abstract datatype</b>: <tt>flag_rule_builder()</tt></p>
<p>  A builder for feature flag rules to be used with <a docgen-rel="seetype" docgen-href="#flag_builder/0" href="#type-flag_builder"><code>flag_builder()</code></a>.</p>

<h3 class="typedecl"><a name="type-variation">variation()</a></h3>
<p><tt>variation() = boolean() | non_neg_integer()</tt></p>


<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#and_match-3">and_match/3</a></td><td>Adds another clause, using the "is one of" operator.</td></tr>
<tr><td valign="top"><a href="#and_not_match-3">and_not_match/3</a></td><td>Adds another clause, using the "is not one of" operator.</td></tr>
<tr><td valign="top"><a href="#boolean_flag-1">boolean_flag/1</a></td><td>A shortcut for setting the flag to use the standard boolean configuration.</td></tr>
<tr><td valign="top"><a href="#clear_rules-1">clear_rules/1</a></td><td>Removes any existing rules from the flag.</td></tr>
<tr><td valign="top"><a href="#clear_user_targets-1">clear_user_targets/1</a></td><td>Removes any existing user targets from the flag.</td></tr>
<tr><td valign="top"><a href="#fallthrough_variation-2">fallthrough_variation/2</a></td><td>Specifies the fallthrough variation for a flag.</td></tr>
<tr><td valign="top"><a href="#if_match-3">if_match/3</a></td><td>Starts defining a flag rule, using the "is one of" operator.</td></tr>
<tr><td valign="top"><a href="#if_not_match-3">if_not_match/3</a></td><td>Starts defining a flag rule, using the "is not one of" operator.</td></tr>
<tr><td valign="top"><a href="#off_variation-2">off_variation/2</a></td><td>Specifies the off variation for a flag.</td></tr>
<tr><td valign="top"><a href="#on-2">on/2</a></td><td>Sets targeting to be on or off for this flag.</td></tr>
<tr><td valign="top"><a href="#then_return-2">then_return/2</a></td><td>Finishes defining the rule, specifying the result variation.</td></tr>
<tr><td valign="top"><a href="#value_for_all_users-2">value_for_all_users/2</a></td><td>Sets the flag to always return the specified variation value for all users.</td></tr>
<tr><td valign="top"><a href="#variation_for_all_users-2">variation_for_all_users/2</a></td><td>Sets the flag to always return the specified variation for all users.</td></tr>
<tr><td valign="top"><a href="#variation_for_user-3">variation_for_user/3</a></td><td>Sets the flag to return the specified variation for a specific user key when  
targeting is on.</td></tr>
<tr><td valign="top"><a href="#variations-2">variations/2</a></td><td>Sets the flag to always return the specified variation value for all users.</td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="and_match-3">and_match/3</a></h3>
<div class="spec">
<p><tt>and_match(UserAttribute::atom() | binary(), Values::[term()], RuleBuilder::<a href="#type-flag_rule_builder">flag_rule_builder()</a>) -&gt; <a href="#type-flag_rule_builder">flag_rule_builder()</a></tt><br></p>
<p><tt>UserAttribute</tt>: the user attribute to match against<br>
<tt>Values</tt>: values to compare to<br>
<tt>RuleBuilder</tt>: the rule builder to modify<br>
</p>
<p>returns: the modified rule builder</p>
</div><p><p>Adds another clause, using the "is one of" operator.</p>
 
  <p>For example, this creates a rule that returns <code>true</code> if the name is "Patsy" and the  
country is "gb":</p>
 
  <pre>      {ok, Flag} = ldclient_testdata:flag(TestData, "flag"),
      RuleBuilder = ldclient_flagbuilder:and_match(&lt;&lt;"country"&gt;&gt;, [&lt;&lt;"gb"&gt;&gt;],
                    ldclient_flagbuilder:if_match(&lt;&lt;"name"&gt;&gt;, [&lt;&lt;"Patsy"&gt;&gt;], Flag)),
      UpdatedFlag = ldclient_flagbuilder:then_return(true, RuleBuilder),
      ldclient_testdata:update(TestData, UpdatedFlag).</pre>
 </p>

<h3 class="function"><a name="and_not_match-3">and_not_match/3</a></h3>
<div class="spec">
<p><tt>and_not_match(UserAttribute::atom() | binary(), Values::[term()], RuleBuilder::<a href="#type-flag_rule_builder">flag_rule_builder()</a>) -&gt; <a href="#type-flag_rule_builder">flag_rule_builder()</a></tt><br></p>
<p><tt>UserAttribute</tt>: the user attribute to match against<br>
<tt>Values</tt>: values to compare to<br>
<tt>RuleBuilder</tt>: the rule builder to modify<br>
</p>
<p>returns: the modified rule builder</p>
</div><p><p>Adds another clause, using the "is not one of" operator.</p>
 
  <p>For example, this creates a rule that returns <code>true</code> if the name is "Patsy" and the  
country is not "gb":</p>
 
  <pre>      {ok, Flag} = ldclient_testdata:flag(TestData, "flag"),
      RuleBuilder = ldclient_flagbuilder:and_not_match(&lt;&lt;"country"&gt;&gt;, [&lt;&lt;"gb"&gt;&gt;],
                    ldclient_flagbuilder:if_match(&lt;&lt;"name"&gt;&gt;, [&lt;&lt;"Patsy"&gt;&gt;], Flag)),
      UpdatedFlag = ldclient_flagbuilder:then_return(true, RuleBuilder),
      ldclient_testdata:update(TestData, UpdatedFlag).</pre>
 </p>

<h3 class="function"><a name="boolean_flag-1">boolean_flag/1</a></h3>
<div class="spec">
<p><tt>boolean_flag(FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>A shortcut for setting the flag to use the standard boolean configuration.</p>
 
  This is the default for all new flags created with <a docgen-rel="seemfa" docgen-href="ldclient_testdata#flag/2" href="ldclient_testdata.html#flag-2"><code>ldclient_testdata:flag/2</code></a>.
  The flag will have two variations, <code>true</code> and <code>false</code> (in that order); it will return
  <code>false</code> whenever targeting is off, and <code>true</code> when targeting is on if no other
  settings specify otherwise.
 </p>

<h3 class="function"><a name="clear_rules-1">clear_rules/1</a></h3>
<div class="spec">
<p><tt>clear_rules(FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Removes any existing rules from the flag.</p>
 
  This undoes the effect of <a docgen-rel="seemfa" docgen-href="#if_match/3" href="#if_match-3"><code>if_match/3</code></a> and <a docgen-rel="seemfa" docgen-href="#if_not_match/3" href="#if_not_match-3"><code>if_not_match/3</code></a>.
 </p>

<h3 class="function"><a name="clear_user_targets-1">clear_user_targets/1</a></h3>
<div class="spec">
<p><tt>clear_user_targets(FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Removes any existing user targets from the flag.</p>
 
  This undoes the effect of <a docgen-rel="seemfa" docgen-href="#variation_for_user/3" href="#variation_for_user-3"><code>variation_for_user/3</code></a>.
 </p>

<h3 class="function"><a name="fallthrough_variation-2">fallthrough_variation/2</a></h3>
<div class="spec">
<p><tt>fallthrough_variation(Variation::<a href="#type-variation">variation()</a>, FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>Variation</tt>: <code>true</code>, <code>false</code>, or the index of the desired variation to return: 0 for the first, 1 for the second, etc.<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Specifies the fallthrough variation for a flag.</p>
 
  <p>The fallthrough is the value that is returned if targeting is on  
and the user was not matched by a more specific target or rule.</p>
 
  If the flag was previously configured with other variations and a boolean variation is specified,
  this also changes the flagbuilder to a boolean flag.
 </p>

<h3 class="function"><a name="if_match-3">if_match/3</a></h3>
<div class="spec">
<p><tt>if_match(UserAttribute::atom() | binary(), Values::[term()], FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_rule_builder">flag_rule_builder()</a></tt><br></p>
<p><tt>UserAttribute</tt>: the user attribute to match against<br>
<tt>Values</tt>: values to compare to<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: a <a docgen-rel="seetype" docgen-href="#flag_rule_builder/0" href="#type-flag_rule_builder"><code>flag_rule_builder()</code></a>; call <a docgen-rel="seemfa" docgen-href="#then_return/2" href="#then_return-2"><code>then_return/2</code></a> to finish the rule,
           or add more tests with <a docgen-rel="seemfa" docgen-href="#and_match/3" href="#and_match-3"><code>and_match/3</code></a> or <a docgen-rel="seemfa" docgen-href="#and_not_match/3" href="#and_not_match-3"><code>and_not_match/3</code></a>.</p>
</div><p><p>Starts defining a flag rule, using the "is one of" operator.</p>
 
  <p>For example, this creates a rule that returns <code>true</code> if the name is "Patsy" or "Edina":</p>
 
  <pre>      {ok, Flag} = ldclient_testdata:flag(TestData, "flag"),
      RuleBuilder = ldclient_flagbuilder:if_match(&lt;&lt;"name"&gt;&gt;, [&lt;&lt;"Patsy"&gt;&gt;, &lt;&lt;"Edina"&gt;&gt;], Flag),
      UpdatedFlag = ldclient_flagbuilder:then_return(true, RuleBuilder),
      ldclient_testdata:update(TestData, UpdatedFlag).</pre>
 </p>

<h3 class="function"><a name="if_not_match-3">if_not_match/3</a></h3>
<div class="spec">
<p><tt>if_not_match(UserAttribute::atom() | binary(), Values::[term()], FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_rule_builder">flag_rule_builder()</a></tt><br></p>
<p><tt>UserAttribute</tt>: the user attribute to match against<br>
<tt>Values</tt>: values to compare to<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: a <a docgen-rel="seetype" docgen-href="#flag_rule_builder/0" href="#type-flag_rule_builder"><code>flag_rule_builder()</code></a>; call <a docgen-rel="seemfa" docgen-href="#then_return/2" href="#then_return-2"><code>then_return/2</code></a> to finish the rule,
           or add more tests with <a docgen-rel="seemfa" docgen-href="#and_match/3" href="#and_match-3"><code>and_match/3</code></a> or <a docgen-rel="seemfa" docgen-href="#and_not_match/3" href="#and_not_match-3"><code>and_not_match/3</code></a>.</p>
</div><p><p>Starts defining a flag rule, using the "is not one of" operator.</p>
 
  <p>For example, this creates a rule that returns <code>true</code> if the name is neither "Saffron" nor "Bubble":</p>
 
  <pre>      {ok, Flag} = ldclient_testdata:flag(TestData, "flag"),
      RuleBuilder = ldclient_flagbuilder:if_not_match(&lt;&lt;"name"&gt;&gt;, [&lt;&lt;"Saffron"&gt;&gt;, &lt;&lt;"Bubble"&gt;&gt;], Flag),
      UpdatedFlag = ldclient_flagbuilder:then_return(true, RuleBuilder),
      ldclient_testdata:update(TestData, UpdatedFlag).</pre>
 </p>

<h3 class="function"><a name="off_variation-2">off_variation/2</a></h3>
<div class="spec">
<p><tt>off_variation(Variation::<a href="#type-variation">variation()</a>, FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>Variation</tt>: <code>true</code>, <code>false</code>, or the index of the desired variation to return: 0 for the first, 1 for the second, etc.<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Specifies the off variation for a flag.</p>
 
  <p>The off variation is the value that is returned whenever targeting is off</p>
 
  If the flag was previously configured with other variations and a boolean Variation is specified,
  this also changes the FlagBuilder to a boolean flag.
 </p>

<h3 class="function"><a name="on-2">on/2</a></h3>
<div class="spec">
<p><tt>on(IsOn::boolean(), FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>IsOn</tt>: true if targeting should be on<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder
 </p>
</div><p><p>Sets targeting to be on or off for this flag.</p>
 
  The effect of this depends on the rest of the flag configuration, just as it does on the
  real LaunchDarkly dashboard. In the default configuration that you get from calling
  <a docgen-rel="seemfa" docgen-href="ldclient_testdata#flag/2" href="ldclient_testdata.html#flag-2"><code>ldclient_testdata:flag/2</code></a> with a new flag key, the flag will return <code>false</code>
  whenever targeting is off, and <code>true</code> when targeting is on.
 </p>

<h3 class="function"><a name="then_return-2">then_return/2</a></h3>
<div class="spec">
<p><tt>then_return(Variation::<a href="#type-variation">variation()</a>, RuleBuilder::<a href="#type-flag_rule_builder">flag_rule_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>Variation</tt>: <code>true</code>, <code>false</code>, or the index of the desired variation to return: 0 for the first, 1 for the second, etc.<br>
<tt>RuleBuilder</tt>: the rule builder to use<br>
</p>
<p>returns: the modified flag builder that initially created this rule builder</p>
</div><p><p>Finishes defining the rule, specifying the result variation.</p>
 
  If the flag was previously configured with other variations and a boolean variation is specified,
  this also changes the FlagBuilder to a boolean flag.
 </p>

<h3 class="function"><a name="value_for_all_users-2">value_for_all_users/2</a></h3>
<div class="spec">
<p><tt>value_for_all_users(Value::term(), FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>Value</tt>: the desired value to be returned for all users<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Sets the flag to always return the specified variation value for all users.</p>
 
  The value may be of any JSON type, as defined by }. This method changes the
  flag to have only a single variation, which is this value, and to return the same
  variation regardless of whether targeting is on or off. Any existing targets or rules
  are removed.
 </p>

<h3 class="function"><a name="variation_for_all_users-2">variation_for_all_users/2</a></h3>
<div class="spec">
<p><tt>variation_for_all_users(Variation::<a href="#type-variation">variation()</a>, FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>Variation</tt>: <code>true</code>, <code>false</code>, or the index of the desired variation to return: 0 for the first, 1 for the second, etc.<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Sets the flag to always return the specified variation for all users.</p>
 
  <p>The variation is set, targeting is switched on, and any existing targets or rules are removed.  
The fallthrough variation is set to the specified value.  
The off variation is left unchanged.</p>
 
  If the flag was previously configured with other variations and a boolean variation is specified,
  this also changes the flagbuilder to a boolean flag.
 </p>

<h3 class="function"><a name="variation_for_user-3">variation_for_user/3</a></h3>
<div class="spec">
<p><tt>variation_for_user(Variation::<a href="#type-variation">variation()</a>, UserKey::string(), FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>Variation</tt>: <code>true</code>, <code>false</code>, or the index of the desired variation to return: 0 for the first, 1 for the second, etc.<br>
<tt>UserKey</tt>: a user key<br>
<tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Sets the flag to return the specified variation for a specific user key when  
targeting is on.</p>
 
  <p>This has no effect when targeting is turned off for the flag.</p>
 
  If the flag was previously configured with other variations and a boolean variation is specified,
  this also changes the flagbuilder to a boolean flag.
 </p>

<h3 class="function"><a name="variations-2">variations/2</a></h3>
<div class="spec">
<p><tt>variations(Values::[<a href="http://www.erlang.org/edoc/doc/ldclient/doc/ldclient_flag.html#type-variation_value">ldclient_flag:variation_value()</a>], FlagBuilder::<a href="#type-flag_builder">flag_builder()</a>) -&gt; <a href="#type-flag_builder">flag_builder()</a></tt><br></p>
<p><tt>FlagBuilder</tt>: the flag builder to modify<br>
</p>
<p>returns: the modified builder</p>
</div><p><p>Sets the flag to always return the specified variation value for all users.</p>
 
  The value may be of any JSON type.
  This method changes the flag to have only a single variation, which is this value,
  and to return the same variation regardless of whether targeting is on or off.
  Any existing targets or rules are removed.
 </p>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc</i></p>
</body>
</html>
